<template>
  <div class="mail-container">
    <!-- é¡¶éƒ¨æ ‡é¢˜æ  -->
    <div class="header">
      <div class="header-left header-left-icons">
  <span class="header-icon header-icon--bl">
    <svg width="1.5em" height="1.5em" viewBox="0 0 32 32" fill="none">
      <rect x="4" y="8" width="24" height="16" rx="4" fill="#2196f3"/>
      <path d="M4 8l12 10l12-10" stroke="#fff" stroke-width="2" fill="none"/>
    </svg>
  </span>
  <span class="header-title">å†…éƒ¨é‚®ä»¶</span>
  <span class="header-icon header-icon--tr">
    <svg width="1.5em" height="1.5em" viewBox="0 0 32 32" fill="none">
      <rect x="4" y="8" width="24" height="16" rx="4" fill="#ffa726"/>
      <path d="M4 8l12 10l12-10" stroke="#fff" stroke-width="2" fill="none"/>
    </svg>
  </span>
</div>
      <div class="header-right">
  <div class="header-search">
    <span class="search-icon">
      <svg width="16" height="16" viewBox="0 0 16 16" fill="none">
        <circle cx="7" cy="7" r="6" stroke="#bdbdbd" stroke-width="1.5" fill="none"/>
        <path d="M12 12l-2.5-2.5" stroke="#bdbdbd" stroke-width="1.5" stroke-linecap="round"/>
      </svg>
    </span>
    <input class="search-input" type="text" placeholder="æœç´¢" />
  </div>
</div>
    </div>

    <div class="content-wrapper">
      <!-- å·¦ä¾§è¾¹æ  -->
      <div class="sidebar">
        <!-- é¡¶éƒ¨æŒ‰é’®åŒºåŸŸ -->
        <div class="sidebar-top">
          <button class="compose-btn active">
            <span class="icon">âœï¸</span>
            å†™ä¿¡
          </button>
          <button class="inbox-btn">
            <span class="icon">ğŸ“¥</span>
            æ”¶ä»¶ç®±
          </button>
        </div>

        <!-- æ–‡ä»¶å¤¹åˆ—è¡¨ -->
        <div class="folder-list">
  <div class="folder-item" :class="{active: selectedFolder==='inbox'}" @click="selectFolder('inbox')">
    <span class="folder-icon">
      <!-- ä¿¡ç®±SVG -->
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><rect x="2" y="6" width="16" height="12" rx="3" stroke="#ff9800" stroke-width="1.5" fill="none"/><path d="M2 6l8 6 8-6" stroke="#ff9800" stroke-width="1.5" fill="none"/></svg>
    </span>
    <span class="folder-name">æ”¶ä»¶ç®±</span><span class="folder-badge">1</span>
  </div>
  <div class="folder-item" :class="{active: selectedFolder==='starred'}" @click="selectFolder('starred')">
    <span class="folder-icon">
      <!-- æ˜Ÿæ ‡SVG -->
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><polygon points="10,2 12,7.5 18,7.5 13,11.5 15,17 10,13.5 5,17 7,11.5 2,7.5 8,7.5" stroke="#ff9800" stroke-width="1.5" fill="none"/></svg>
    </span>
    <span class="folder-name">æ˜Ÿæ ‡é‚®ä»¶</span>
  </div>
  <div class="folder-item" :class="{active: selectedFolder==='sent'}" @click="selectFolder('sent')">
    <span class="folder-icon">
      <!-- çº¸é£æœºSVG -->
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><polygon points="2,18 18,10 2,2 5,10 2,18" stroke="#ff9800" stroke-width="1.5" fill="none"/></svg>
    </span>
    <span class="folder-name">å·²å‘é€</span>
  </div>
  <div class="folder-item">
    <span class="folder-icon">
      <!-- æ–‡ä»¶å¤¹SVG -->
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><rect x="2" y="6" width="16" height="10" rx="2" stroke="#ff9800" stroke-width="1.5" fill="none"/><path d="M2 6l6-4 4 4h6" stroke="#ff9800" stroke-width="1.5" fill="none"/></svg>
    </span>
    <span class="folder-name">è‰ç¨¿ç®±</span><span class="folder-badge">4</span>
  </div>
  <div class="folder-item">
    <span class="folder-icon">
      <!-- åƒåœ¾æ¡¶SVG -->
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><rect x="5" y="7" width="10" height="9" rx="2" stroke="#ff9800" stroke-width="1.5" fill="none"/><path d="M3 7h14" stroke="#ff9800" stroke-width="1.5" fill="none"/><path d="M8 10v3" stroke="#ff9800" stroke-width="1.2"/><path d="M12 10v3" stroke="#ff9800" stroke-width="1.2"/></svg>
    </span>
    <span class="folder-name">å·²åˆ é™¤</span>
  </div>
  <div class="folder-item">
    <span class="folder-icon">
      <!-- åƒåœ¾ç®±SVG -->
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><rect x="2" y="6" width="16" height="12" rx="3" stroke="#ff9800" stroke-width="1.5" fill="none"/><rect x="8" y="10" width="4" height="4" rx="1" stroke="#ff9800" stroke-width="1.2" fill="none"/></svg>
    </span>
    <span class="folder-name">åƒåœ¾ç®±</span><span class="folder-badge">8</span>
  </div>
  <div class="folder-item">
    <span class="folder-icon">
      <!-- æ–‡ä»¶å¤¹SVG -->
      <svg width="20" height="20" viewBox="0 0 20 20" fill="none"><polygon points="2,18 18,10 2,2 5,10 2,18" stroke="#ff9800" stroke-width="1.5" fill="none"/></svg>
    </span>
    <span class="folder-name">æˆ‘çš„æ–‡ä»¶å¤¹</span>
  </div>
</div>
      </div>

      <!-- ä¸»å†…å®¹åŒºåŸŸ -->
      <MainContent :folderName="folderLabels[selectedFolder]" :emails="allEmails[selectedFolder]" />
    </div>
  </div>
</template>

<script setup lang="ts">
import MainContent from './components/mainContent.vue'
import { ref } from 'vue'
import '@/views/mail/mail.css'

interface Email {
  id: number
  sender: string
  subject: string
  time: string
  date: string // æ–°å¢æ—¥æœŸå­—æ®µ yyyy-MM-dd
}

// ä½¿ç”¨ mockjs ç”Ÿæˆ 50 æ¡ä»¥ä¸Šå‡æ•°æ®
import Mock from 'mockjs'

function genEmails(folder: string, count: number): Email[] {
  // ç”Ÿæˆåˆ†å¸ƒåœ¨ä¸åŒæ—¶é—´æ®µçš„æ—¥æœŸ
  const today = new Date()
  function formatDate(d: Date) {
    return d.getFullYear() + '-' + String(d.getMonth()+1).padStart(2,'0') + '-' + String(d.getDate()).padStart(2,'0')
  }
  // å››ç±»æ—¥æœŸåˆ†å¸ƒ
  const buckets = [
    { label: 'ä»Šå¤©', offset: () => 0 },
    { label: 'æ˜¨å¤©', offset: () => -1 },
    { label: 'ä¸€å‘¨å†…', offset: () => -Math.floor(Math.random()*5)-2 }, // éšæœº-2~-6å¤©
    { label: 'ä¸€å‘¨å‰', offset: () => -Math.floor(Math.random()*20)-7 } // éšæœº-7~-26å¤©
  ]
  return Array.from({length: count}).map((_, i) => {
    let bucketIdx
    const r = Math.random()
    if (r < 0.15) bucketIdx = 0 // ä»Šå¤©
    else if (r < 0.3) bucketIdx = 1 // æ˜¨å¤©
    else if (r < 0.7) bucketIdx = 2 // ä¸€å‘¨å†…
    else bucketIdx = 3 // ä¸€å‘¨å‰
    const offset = buckets[bucketIdx].offset()
    const date = formatDate(new Date(today.getTime() + offset*86400000))
    return {
      id: i+1,
      sender: folder === 'sent' ? 'æˆ‘' : Mock.Random.cname(),
      subject: `${folder === 'inbox' ? 'æ”¶ä»¶ç®±' : folder === 'starred' ? 'æ˜Ÿæ ‡' : 'å·²å‘é€'}é‚®ä»¶ - ` + Mock.Random.ctitle(8, 20),
      time: Mock.Random.time('HH:mm'),
      date
    }
  })
}

const allEmails: Record<string, Email[]> = {
  inbox: genEmails('inbox', 60),
  starred: genEmails('starred', 55),
  sent: genEmails('sent', 52)
}


const folderLabels: Record<string, string> = {
  inbox: 'æ”¶ä»¶ç®±',
  starred: 'æ˜Ÿæ ‡é‚®ä»¶',
  sent: 'å·²å‘é€'
}

const selectedFolder = ref('inbox')
function selectFolder(folder: string) {
  selectedFolder.value = folder
}
</script>